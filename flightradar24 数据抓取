from selenium import webdriver
import re
import requests
from selenium.webdriver.common.by import By
import time
browser=webdriver.Chrome()
browser.get("https://www.flightradar24.com/data/airports/china")

#通过航班网页进行获取每个机场的URL
def flight_url():
    urls = browser.find_elements_by_xpath("//a")
    #过滤出无效的url
    ur = urls[108:-8]
    urls = []
    #使用正则去掉不需要的url
    for url in ur:
        url = url.get_attribute("href")
        url = re.subn(r'.*?#$', '', url)
        urls.append(url[0])
    #去除列表中的 ''
    while '' in urls:
         urls.remove('')

    for i in urls:
        #解析每个url
        browser.get(i)

        #得到每个url里面的所有航班和航班之间连接信息
        fl = browser.find_elements_by_xpath('//*[@id="cnt-data-content"]/div/div[2]/div/aside[2]/div/ul/li/a')
        for j in fl:
        #当url='https://www.flightradar24.com/data/airports/china/yie 时会出现url未知错误'
            lianjie = j.text

#获取机场的名字
new_lis = []
def flight_name():
    lis = browser.find_elements_by_css_selector("td")
    for i in lis:
        L=i.text
        if len(L)>1:
            new_lis.append(L)

browser.close()

if __name__ == '__main__':
    flight_name()
    flight_url()
    print(new_lis)
