'''使用自动化测试工具，翻译国家机场名称'''

from selenium import webdriver
from selenium.webdriver.common import keys
import time
import pymysql as py
import pandas as pd

driver = webdriver.PhantomJS()


# 从数据库中读取数据
def getConnection():
    return py.connect(host='localhost', user='root', password='hh226752',db = 'flightradar24', charset = 'utf8' )

# 加载数据库中数据
conn = getConnection()
cur = conn.cursor()
cn = cur.execute('select Airports_name from test')

# 将数据转到 list1中，数据类型为list
rows = cur.fetchall()
rows = list(rows)
list1=[]
for i in rows:
    list1.append(list(i))
list2 = []
for i in list1:
    list2.append(i[0])
print(list2)
# 开始执行翻译程序
fanyi_lis = []
for i in list2:
    driver.get('http://fanyi.baidu.com/#en/zh/')
    driver.find_element_by_id('baidu_translate_input').send_keys(i)

    # 等待3秒钟翻译时间
    time.sleep(3)

    # 开始翻译
    danci  = driver.find_elements_by_css_selector('#main-outer > div > div > div.translate-wrap > div.translateio > div.translate-main.clearfix > div.trans-right > div > div > div.output-bd > p.ordinary-output.target-output.clearfix > span')
    for j in danci:
        list3 = [i,j.text]
        fanyi_lis.append(list3)
        print(i,j.text)
    # 完成翻译必须清空选区内容
    driver.find_element_by_id("baidu_translate_input").clear()

# #driver.save_screenshot('youdao.png')
name = ['英文','中文']
test = pd.DataFrame(columns=name,data=fanyi_lis)
test.to_csv(r"d:\机场名称.csv")

driver.quit()
